class Toolbar extends HTMLElement{constructor(){var e;super(),this.stickyBounds=document.getElementById("CollectionProductGrid").querySelector(".productListing"),this.queryParams(),this.closeModalClick(),this.querySelector("[data-view-as]")&&(this.mediaView=this.querySelector("[data-view-as]"),this.mediaViewMobile=this.querySelector("[data-view-as-mobile]"),this.mediaView.querySelectorAll(".icon-mode").forEach(e=>{e.addEventListener("click",this.onClickModeButtonHandler.bind(this))}),this.mediaViewMobile.querySelectorAll(".icon-mode").forEach(e=>{e.addEventListener("click",this.onClickModeButtonMobileHandler.bind(this))}),this.debouncedOnResizeMediaQuery=debounce(()=>{this.setActiveViewModeMediaQuery(!1)},200),e=window.innerWidth,window.addEventListener("resize",()=>{window.innerWidth!=e&&(e=window.innerWidth,this.debouncedOnResizeMediaQuery())}),window.addEventListener("load",()=>{this.debouncedOnResizeMediaQuery()})),this.querySelector("[data-limited-view]")&&(this.limitView=this.querySelector("[data-limited-view]"),this.limitView.querySelectorAll("[data-limited-view-item]").forEach(e=>{e.addEventListener("click",this.onClickLimitButtonHandler.bind(this))})),this.querySelector("[data-toggle]")&&(this.querySelectorAll("[data-toggle]").forEach(e=>{e.addEventListener("click",this.onClickDropdownButtonHandler.bind(this))}),document.body.addEventListener("click",this.onBodyClickEvent.bind(this))),this.querySelector("[data-sorting]")&&(this.sortBys=this.querySelectorAll("[data-sorting]"),null!=this.sortBys[0].querySelector("[data-sort-by-item]"))&&this.sortBys.forEach(e=>{e.querySelectorAll("[data-sort-by-item]").forEach(e=>{e.addEventListener("click",this.onClickSortByButtonHandler.bind(this))})}),this.checkNeedToConvertCurrency()&&Currency.convertAll(window.shop_currency,$("#currencies .active").attr("data-currency"),"span.money","money_format")}queryParams(){if(Shopify.queryParams={},0<location.search.length)for(var e,t=0,i=location.search.substr(1).split("&");t<i.length;t++)1<(e=i[t].split("=")).length&&(Shopify.queryParams[decodeURIComponent(e[0])]=decodeURIComponent(e[1]))}createURLHash(e){var t=$.param(Shopify.queryParams).replace(/%2B/g,"+");return e?""!=t?e+"?"+t:e:""!=t?location.pathname+"?"+t:location.pathname}updateURLHash(e){delete Shopify.queryParams.page;e=this.createURLHash(e);history.pushState({param:Shopify.queryParams},e,e)}checkNeedToConvertCurrency(){return window.show_multiple_currencies&&Currency.currentCurrency!=shopCurrency||window.show_auto_currency}onClickDropdownButtonHandler(e){e=e.currentTarget;"mobile"===e.dataset.mobile&&document.body.classList.add("toolbar-modal-open"),"false"===e.getAttribute("aria-expanded")?e.setAttribute("aria-expanded",!0):e.setAttribute("aria-expanded",!1)}onClickSortByButtonHandler(e){e.preventDefault();var t,i,r=e.currentTarget;this.sortBy=r.closest("[data-sorting]"),r.classList.contains("is-active")||(r.querySelector(".text").getAttribute("data-value"),t=r.querySelector(".text").getAttribute("data-href"),i=r.querySelector(".text").innerText,null!=this.sortBy.querySelector(".label-text")&&(this.sortBy.querySelector(".label-text").innerText=i),null!=this.sortBy.querySelector("[data-toggle]")&&this.sortBy.querySelector("[data-toggle]")?.setAttribute("aria-expanded",!1),this.sortBy.querySelectorAll("[data-sort-by-item]").forEach(e=>{e.classList.remove("is-active")}),r.classList.add("is-active"),"mobile"===this.sortBy.dataset.mobile&&(this.querySelector('[data-toggle][data-mobile="mobile"]').setAttribute("aria-expanded",!1),document.body.classList.remove("toolbar-modal-open")),window.show_storefront_filter?((i=document.querySelector("collection-filters-form")).querySelector('[name="sort_by"]').value=t,i.onSubmitHandlerFromSortBy(e,i.querySelector("form"))):(Shopify.queryParams.sort_by=t,this.updateURLHash(),r=this.createURLHash(),this.renderPage(r)))}getSections(){return[{id:"main-collection-product-grid",section:document.getElementById("main-collection-product-grid").dataset.id}]}renderPage(t){var e=this.getSections();document.body.classList.add("has-halo-loader"),e.forEach(e=>{this.renderSectionFromFetch(t,e)})}renderSectionFromFetch(e,t){fetch(e).then(e=>e.text()).then(e=>{this.renderSidebar(e),this.renderProductGrid(e)})}renderSidebar(e){document.getElementById("main-collection-filters")&&(e=(new DOMParser).parseFromString(e,"text/html").getElementById("main-collection-filters").innerHTML,document.getElementById("main-collection-filters").innerHTML=e)}renderProductGrid(e){e=(new DOMParser).parseFromString(e,"text/html").getElementById("CollectionProductGrid").querySelector(".collection").innerHTML;document.getElementById("CollectionProductGrid").querySelector(".collection").innerHTML=e,this.setActiveViewModeMediaQuery(!0),window.compare.show&&this.setLocalStorageProductForCompare({link:$("a[data-compare-link]"),onComplete:null}),window.wishlist.show&&this.setLocalStorageProductForWishlist(),window.innerWidth<1025&&window.scrollTo({top:document.getElementById("CollectionProductGrid").getBoundingClientRect().top+window.pageYOffset-50,behavior:"smooth"}),document.body.classList.remove("has-halo-loader")}setLocalStorageProductForCompare(e){var r=JSON.parse(localStorage.getItem("compareItem")),t=$("[data-product-compare-handle]");null!==r&&0<t.length&&t.each((e,t)=>{var t=$(t),i=t.data("product-compare-handle");0<=r.indexOf(i)?(t.find(".compare-icon").addClass("is-checked"),t.find(".text").text(window.compare.added),t.find("input").prop("checked",!0)):(t.find(".compare-icon").removeClass("is-checked"),t.find(".text").text(window.compare.add),t.find("input").prop("checked",!1))})}setLocalStorageProductForWishlist(){var e=localStorage.getItem("wishlistItem")?JSON.parse(localStorage.getItem("wishlistItem")):[];localStorage.setItem("wishlistItem",JSON.stringify(e)),0<e.length&&(e=JSON.parse(localStorage.getItem("wishlistItem"))).forEach(e=>{this.setProductForWishlist(e)}),$("[data-wishlist-count]").text(e.length)}setProductForWishlist(e){var t=JSON.parse(localStorage.getItem("wishlistItem")),i=$('[data-wishlist-handle="'+e+'"]');0<=t.indexOf(e)?i.addClass("wishlist-added").find(".text").text(window.wishlist.added):i.removeClass("wishlist-added").find(".text").text(window.wishlist.add)}setActiveViewModeMediaQuery(e=!0){var t=this.mediaView?.querySelector(".icon-mode.active"),i=this.mediaViewMobile?.querySelector(".icon-mode.active"),r=parseInt(t?.dataset.col),a=window.innerWidth;1!=r?(document.querySelector(".sidebar--layout_vertical")?a<768?3!=r&&4!=r&&5!=r||(r=2,t.classList.remove("active"),i.classList.remove("active"),this.mediaView.querySelector(".grid-2").classList.add("active"),this.mediaViewMobile.querySelector(".grid-2").classList.add("active")):a<=1100&&768<=a?5!=r&&4!=r&&3!=r||(r=2,t.classList.remove("active"),i.classList.remove("active"),this.mediaView.querySelector(".grid-2").classList.add("active"),this.mediaViewMobile.querySelector(".grid-2").classList.add("active")):a<1299&&1100<a?5!=r&&4!=r||(r=3,t.classList.remove("active"),i.classList.remove("active"),this.mediaView.querySelector(".grid-3").classList.add("active"),this.mediaViewMobile.querySelector(".grid-3").classList.add("active")):a<1700&&1299<=a&&5==r&&(r=4,t.classList.remove("active"),i.classList.remove("active"),this.mediaView.querySelector(".grid-4").classList.add("active"),this.mediaViewMobile.querySelector(".grid-4").classList.add("active")):a<768?3!=r&&4!=r&&5!=r||(r=2,t.classList.remove("active"),i.classList.remove("active"),this.mediaView.querySelector(".grid-2").classList.add("active"),this.mediaViewMobile.querySelector(".grid-2").classList.add("active")):a<992&&768<=a?4!=r&&5!=r||(r=3,t.classList.remove("active"),i.classList.remove("active"),this.mediaView.querySelector(".grid-3").classList.add("active"),this.mediaViewMobile.querySelector(".grid-3").classList.add("active")):a<1600&&992<=a&&5==r&&(r=4,t.classList.remove("active"),i.classList.remove("active"),this.mediaView.querySelector(".grid-4").classList.add("active"),this.mediaViewMobile.querySelector(".grid-4").classList.add("active")),this.initViewModeLayout(r)):e&&this.initViewModeLayout(r)}changeBannerPositions(i){const r=document.getElementById("main-collection-product-grid"),a=[...r.querySelectorAll(".product")],e=a.find(e=>1==e.dataset.productBanner),t=a.find(e=>2==e.dataset.productBanner),o=a.find(e=>3==e.dataset.productBanner),s=[e,t,o];var c=s.map(e=>{var t=a.indexOf(e);return{bannerNumber:e.dataset.productBanner,currentIndex:t,originalIndex:parseInt(e.dataset.firstPosition)}}).map(e=>{let t=e.currentIndex;switch(i){case 2:1==e.bannerNumber?t=2:2==e.bannerNumber?t=5:3==e.bannerNumber&&(t=8),r.classList.add("banner-full-width");break;case 3:t=3==e.bannerNumber?e.originalIndex:e.originalIndex-1;break;case 4:t=e.originalIndex;break;case 5:t=3==e.bannerNumber?e.originalIndex+3:e.originalIndex+1;break;default:r.classList.remove("banner-full-width")}return{bannerNumber:e.bannerNumber,originalIndex:e.originalIndex,currentIndex:t}});r.removeChild(e),r.removeChild(t),r.removeChild(o),c.forEach(t=>{var e=[...r.querySelectorAll(".product")][t.currentIndex],i=s.find(e=>e.dataset.productBanner==t.bannerNumber);r.insertBefore(i,e)})}initViewModeLayout(e){var t=document.getElementById("CollectionProductGrid").querySelector(".productListing");if(t){if(1===e)t.classList.remove("productGrid","column-5","column-4","column-3","column-2"),t.classList.add("productList");else switch(e){case 2:t.classList.remove("productList","column-5","column-4","column-3"),t.classList.add("productGrid","column-2");break;case 3:t.classList.remove("productList","column-5","column-4","column-2"),t.classList.add("productGrid","column-3");break;case 4:t.classList.remove("productList","column-5","column-3","column-2"),t.classList.add("productGrid","column-4");break;case 5:t.classList.remove("productList","column-4","column-3","column-2"),t.classList.add("productGrid","column-5")}document.querySelector(".collection-masonry")&&resizeAllGridItems(),document.querySelector(".collection-banner-adv")&&this.changeBannerPositions(e)}}onClickModeButtonHandler(e){e.preventDefault();var e=e.currentTarget,t=this.mediaView.querySelector(".icon-mode.active"),i=parseInt(e.dataset.col);e.classList.contains("active")||(t.classList.remove("active"),e.classList.add("active"),this.mediaViewMobile.querySelectorAll(".icon-mode").forEach(e=>{parseInt(e.dataset.col)==i?e.classList.add("active"):e.classList.remove("active")}),this.initViewModeLayout(i))}onClickModeButtonMobileHandler(e){e.preventDefault();var e=e.currentTarget,t=this.mediaViewMobile.querySelector(".icon-mode.active"),i=parseInt(e.dataset.col);e.classList.contains("active")||(t.classList.remove("active"),e.classList.add("active"),this.mediaView.querySelectorAll(".icon-mode").forEach(e=>{parseInt(e.dataset.col)==i?e.classList.add("active"):e.classList.remove("active")}),this.initViewModeLayout(i))}onClickLimitButtonHandler(e){e.preventDefault();var t,e=e.currentTarget;e.classList.contains("is-active")||(t=parseInt(e.querySelector(".text").dataset.value),this.limitView.querySelector(".label-text").innerText=t,this.limitView.querySelector("[data-toggle]").setAttribute("aria-expanded",!1),this.limitView.querySelectorAll("[data-limited-view-item]").forEach(e=>{e.classList.remove("is-active")}),e.classList.add("is-active"),$.ajax({type:"POST",url:"/cart.js",dataType:"json",data:{"attributes[pagination]":t},success:function(e){window.location.reload()},error:function(e,t){alert($.parseJSON(e.responseText).description)}}))}connectedCallback(){this.onScrollHandler=this.onScroll.bind(this),window.addEventListener("scroll",this.onScrollHandler,!1)}disconnectedCallback(){window.removeEventListener("scroll",this.onScrollHandler)}onScroll(){var e=window.pageYOffset||document.documentElement.scrollTop,t=$("#CollectionProductGrid .productListing").offset().top+100;window.innerWidth<1025&&(t<e?(requestAnimationFrame(this.showSticky.bind(this)),document.body.classList.contains("scroll-up")?(t=document.querySelector("sticky-header").offsetHeight,this.style.top=t+"px"):document.body.classList.contains("scroll-down")&&(this.style.top=0)):requestAnimationFrame(this.hideSticky.bind(this))),this.currentScrollTop=e}hideSticky(){this.classList.remove("show-sticky","animate"),this.closeDropdownPopupSticky()}showSticky(){this.classList.add("show-sticky","animate"),this.closeDropdownPopupSticky()}closeModalClick(){this.closeMobileModal=this.querySelector("[data-sorting][data-mobile] .close-mobile-modal"),this.closeMobileModal.addEventListener("click",()=>{this.querySelector('[data-toggle][data-mobile="mobile"]').setAttribute("aria-expanded",!1),document.body.classList.remove("toolbar-modal-open")})}closeDropdownPopupSticky(){this.querySelector(".label-tab")&&this.querySelectorAll(".label-tab").forEach(e=>{e.setAttribute("aria-expanded",!1)})}onBodyClickEvent(i){this.querySelector("[data-toggle]")&&this.querySelectorAll("[data-toggle]").forEach(e=>{if("mobile"===e.dataset.mobile){const t=this.querySelector("[data-sorting][data-mobile]");t.contains(i.target)||e.contains(i.target)||(e.setAttribute("aria-expanded",!1),document.body.classList.contains("toolbar-modal-open")&&document.body.classList.remove("toolbar-modal-open"))}else{var t=e.nextElementSibling;t.contains(i.target)||e.contains(i.target)||e.setAttribute("aria-expanded",!1)}})}}customElements.define("toolbar-item",Toolbar);