class QuickSearch extends HTMLElement{constructor(){super(),(this.quickSearch=this).productToShow=this.getAttribute("data-product-to-show"),this.headerInputs=document.querySelectorAll('input[name="q"]'),this.searchResults=this.getElementsByClassName("quickSearchResultsContent")[0],this.searchResultsWidget=this.getElementsByClassName("quickSearchResultsWidget")[0],this.detailsContainer=this.closest("details"),this.header__search=document.querySelector(".header__search-full"),this.header__search_popup_close=document.querySelector(".header-search-popup-close"),this.debouncedOnFocus=debounce(e=>{this.doQuickSearch(),QuickSearch.openPanel(e)},200),this.headerInputs.forEach(e=>{e.addEventListener("input",this.debouncedOnFocus.bind(this))}),this.headerInputs.forEach(e=>{e.addEventListener("focus",e=>{QuickSearch.openPanel(e)})}),this.header__search.addEventListener("click",e=>{1025<window.innerWidth&&document.querySelector("#shopify-section-header-07")&&(document.querySelector(".search_details").hasAttribute("open")?document.querySelector("body").classList.remove("open_search"):document.querySelector("body").classList.add("open_search"))}),this.header__search_popup_close?.addEventListener("click",e=>{document.querySelector(".search_details").hasAttribute("open")&&document.querySelector(".search_details").removeAttribute("open")}),document.body.addEventListener("click",e=>{!document.body.classList.contains("open_search")||this.contains(e.target)||0!==$(e.target).closest(".header__search").length||(this.detailsContainer.removeAttribute("open"),1025<window.innerWidth&&document.querySelector("body").classList.add("open_search"))})}static openPanel(e){e.target.closest("details").getAttribute("open")||(e.target.closest("details").setAttribute("open",!0),1025<window.innerWidth&&(document.querySelector("#shopify-section-header-07")||document.querySelector("body").classList.add("open_search")))}doQuickSearch(){this.headerInputs.forEach(e=>{var s;""===e.value.trim()?(this.searchResults.classList.remove("is-show"),this.searchResults.classList.add("is-hidden"),this.searchResultsWidget?.classList.remove("is-hidden"),this.searchResultsWidget?.classList.add("is-show")):1<=e.value.length&&(this.quickSearch.classList.add("is-loading"),e=e.value,s=this.productToShow,this.renderQuickSearchFromFetch(`/search?view=ajax_quick_search&q=${e}*&type=product`,e,s))})}renderQuickSearchFromFetch(e,o,n){fetch(e).then(e=>e.json()).then(e=>{var s,t,c,i,r=e.results,a=e.results_count;0<r.length?(this.searchResults.getElementsByClassName("productEmpty")[0].style.display="none",s=[],r.forEach(e=>{s.push(e.handle)}),t=this.quickSearch,c=this.searchResults,i=this.searchResultsWidget,$.ajax({type:"get",url:window.routes.collection_all,cache:!1,data:{view:"ajax_product_card",constraint:`limit=${n}+sectionId=list-result+list_handle=`+encodeURIComponent(s)},beforeSend:function(){},success:function(e){var s=`/search?q=${o}*&type=product`;c.getElementsByClassName("productGrid")[0].innerHTML=e,c.getElementsByClassName("productViewAll")[0].style.display="block",c.getElementsByClassName("button-view-all")[0].setAttribute("href",s),c.getElementsByClassName("button-view-all")[0].innerText=a},complete:function(){t.classList.remove("is-loading"),i?.classList.remove("is-show"),i?.classList.add("is-hidden"),c.classList.remove("is-hidden"),c.classList.add("is-show"),(window.show_multiple_currencies&&Currency.currentCurrency!=shopCurrency||window.show_auto_currency)&&Currency.convertAll(window.shop_currency,$("#currencies .active").attr("data-currency"),"span.money","money_format")}})):(this.searchResults.getElementsByClassName("productGrid")[0].innerHTML="",this.searchResults.getElementsByClassName("productViewAll")[0].style.display="none",this.searchResults.getElementsByClassName("productEmpty")[0].style.display="block",this.searchResults.getElementsByClassName("keyword")[0].innerHTML=`<strong>${o}</strong>`,this.quickSearch.classList.remove("is-loading"),this.searchResultsWidget?.classList.remove("is-show"),this.searchResultsWidget?.classList.add("is-hidden"),this.searchResults.classList.remove("is-hidden"),this.searchResults.classList.add("is-show"))})}}customElements.define("quick-search",QuickSearch);